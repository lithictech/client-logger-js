!function(e,n){void 0===e&&void 0!==window&&(e=window),"function"==typeof define&&define.amd?define([],(function(){return e.structuredClientLogging=n()})):"object"==typeof module&&module.exports?module.exports=n():e.structuredClientLogging=n()}(this,(function(){"use strict";function e(){for(var e={},n=0;n<arguments.length;n++){var r=arguments[n];for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])}return e}var n,r,o,t=null,i=0,l=[],u=null,s={debug:10,info:20,warn:30,error:40};function c(){if(0===l.length)return Promise.resolve();if(!o){var t=l.length-r;return t>0&&(console.log("WARNING: Dropping "+t+" logs because logging is not configured"),l=l.slice(t,t+r)),Promise.resolve()}var i=e(n,{lines:l});return l=[],o(i)}var d={configure:function(e){if((e=e||{}).disabled)return t=!0,n=null,o=null,l=[],void(u&&clearInterval(u));s[e.level]?i=s[e.level]:console.error("invalid log level:",e.level),n=e.requestFields||{},r=e.lineBuffer||50,o=e.sendLogs?e.sendLogs:function(n){return fetch(e.endpoint,{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).catch((function(e){return console.error("Failed to send logs:",e),Promise.reject(e)}))},null!==u&&clearInterval(u),u=setInterval(c,e.interval||1e4)},createLogger:function n(o,u){function d(n){var d=s[n];return function(s,f){t||d<i||(l.push({logger:o,at:(new Date).toISOString(),level:n,event:s,context:e(u,f)}),l.length>=r&&c())}}return{debug:d("debug"),info:d("info"),warn:d("warn"),error:d("error"),bind:function(r){return n(o,e(u,r))}}},flush:c};return"object"==typeof module&&module.exports&&(module.exports=d),d}));